\chapter{Conclusion}
\label{cha:conc}
Research into the use of network tomography in real-work networks is limited, with most studies being conducted on synthetic topologies. Additionally, in previous work that has focused on applying network tomography to real-world scenarios, there is little investigation into adversarial settings. In this thesis we have addressed this gap in the corpus through studying the classification of nefariously delaying routers in stochastically routing real-world networks. This probabilistic delaying of packets by routers could be indicative of a compromised router snooping data using DPI or ex-filtrating packets.\par
We have proposed the technique of \textit{PDA tomography}, a novel implementation of network tomography to infer the size of router's packet queue buffers in a stochastically routing network. This implementation computes the average packet delay over a set of controllable cycle-free probing paths through the network. We have established a relationship between average packet delays and packet delaying behaviour.\par
We have developed two classifiers which use PDA tomography to identify nefarious routers in a network. One classifier was developed under the assumptions that log files allowing for comparison of observed router PDA's to a PDA of the routers when not exhibiting nefarious delaying behaviour. The other classifier does not assume these log files are available, using router PDA alone to identify nefarious routers.\par
The classifier using a comparison to baseline metrics was found to be effective in identifying nefarious routers with a false positive rate < 0.2 and a false negative rate of < 0.2. The classifier which uses PDA alone was found to have a more accurate classification of nefarious routers outside of these sensitive and specificity ranges.\par
To optimise the accuracy of our classification of nefarious routers we introduced two candidate optimisations to the tomographic pipeline. The first of these, proportional probe allocation (PPA), was found to improve the accuracy of both classifiers across all topologies. Observations of classifier performance under PPA were found to corroborate analytical results from calculation of the Cramér–Rao bound. The lower bound on accuracy of network tomography, given by the Cramér–Rao bound, was improved by PPA in each topology. Additionally, the Cramér–Rao bound decreased proportionally to the number of routers in topology for both equivalent probe allocation and PPA.\par
The second optimisation was intended to account for the impact of inbound traffic on router's queue buffer length. This would allow for changes in router queue buffer size due to nefarious delaying to be more accurately identified. To accomplish this the PDA of each router was normalised by the degree of the router. This was found to negatively impact the performance of both classifier across all topologies.\par

\section{Future Work}
\label{sec:Cfuture}
While this thesis has provided a foundation for the use of network tomography to classify nefarious routers there are many areas for potential future improvements. Studies conducted around the impact of alternative background routing protocols and advanced attacks such as OSPF poising would greatly expand the scope of this work. A very promising area for future work would be investigation into the use of a combination of PDA and PDV metrics in advanced classification techniques such as K-nearest neighbours.\par
Additional research building on our work focusing on mapping router level PDA to hold probability (in Appendix B) has much potential. Specifically, analysis into if the underlying parametric functions which relate these two metrics is robust enough to be inverted. The sensitivity of this relationship to network topology, traffic intensity, and alternate network properties could also hold promise.\par 
An analysis using a network simulation software package such as NS3 could be used to investigate the impact of a TCP rather than UDP based network. If real-world network traffic data sets with probabilistically delaying routers could be obtained future analysis of this methods efficacy in real-world settings could be studied. Larger real-world topologies could also be analysed to see if our observations of classifier efficacy hold for networks where many more probe paths are required.\par
Discretisation of packet delay metrics obtained from network tomography into segments throughout the measurement interval could be attempted in future work. This could generate a distribution closer to the underlying router buffer queue length distribution. As seen in results for classifier one, when using the underlying router buffer queue length distribution classification is extremely precise and accurate. Shifting the results of the tomographic analysis towards this PDA distribution could potentially improve accuracy.
